@page "/edit-fueltype/{Id:int}"
@using ProksRent_WebAPI.DTOs
@using ProksRent_WebAPI.Services
@inject IFuelTypeService FuelTypeService
@inject NavigationManager NavigationManager

<h3>@(Id == 0 ? "Add Fuel Type" : "Edit Fuel Type")</h3>

<EditForm Model="fuelType" OnValidSubmit="HandleValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="mb-3">
        <label for="name" class="form-label">Name</label>
        <InputText id="name" class="form-control" @bind="fuelType.Name" />
    </div>

    <button class="btn btn-primary" type="submit">Save</button>
    <button class="btn btn-secondary ms-2" @onclick="() => NavigationManager.NavigateTo("/fueltypes")">Cancel</button>
</EditForm>

@code {
    [Parameter] public int Id { get; set; }

    private FuelTypeDto fuelType = new();

    protected override async Task OnInitializedAsync()
    {
        if (Id != 0)
        {
            var dto = await FuelTypeService.GetFuelTypeByIdAsync(Id);
            if (dto != null)
                fuelType = dto;
        }
    }

    private async Task HandleValidSubmit()
    {
        if (Id == 0)
            await FuelTypeService.AddFuelTypeAsync(fuelType);
        else
            await FuelTypeService.UpdateFuelTypeAsync(fuelType);

        NavigationManager.NavigateTo("/fueltypes");
    }
}
